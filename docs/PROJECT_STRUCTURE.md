# Описание структуры проекта BookIT

## Общая информация

BookIT разработан с использованием современных технологий и практик, с упором на производительность, масштабируемость и
поддержку. Проект реализован с применением асинхронного Python и FastAPI для backend части системы.

## Технологический стек

- **Язык программирования**: Python 3.12+
- **Web Framework**: FastAPI
- **ORM**: SQLAlchemy (асинхронный режим)
- **База данных**: PostgreSQL
- **Объектное хранилище**: MinIO (S3-совместимое)
- **Контейнеризация**: Docker и Docker Compose
- **Web-сервер**: Nginx
- **CI/CD**: GitLab CI

## Архитектура приложения

Backend приложения построен по принципу слоистой архитектуры с четким разделением ответственности. Основные слои:

### 1. Presentation Layer (API Layer)

- **Назначение**: Обработка HTTP запросов, валидация входных данных, формирование ответов
- **Ключевые компоненты**: FastAPI роуты, Pydantic модели
- **Расположение**: `/backend/src/routers/`

### 2. Service Layer (Business Logic Layer)

- **Назначение**: Содержит бизнес-логику приложения, координирует работу с репозиториями, обрабатывает данные
- **Ключевые компоненты**: Service-классы для каждой бизнес-сущности
- **Расположение**: `/backend/src/services/`

### 3. Data Access Layer

- **Назначение**: Взаимодействие с базой данных и другими источниками данных
- **Ключевые компоненты**: Repository-классы, модели данных SQLAlchemy
- **Расположение**: `/backend/src/models/`, `/backend/src/repo/`

### 4. Infrastructure Layer

- **Назначение**: Конфигурация системы, подключение к внешним сервисам, управление миграциями
- **Ключевые компоненты**: Конфигурационные модули, миграции Alembic, клиенты для внешних сервисов
- **Расположение**: `/backend/src/core/`

## Основные домены (бизнес-сущности)

Система работает со следующими ключевыми бизнес-сущностями:

### Buildings (Здания)

- Управление информацией о зданиях коворкинга
- Хранение геолокации, адресов, часов работы и изображений
- Связано с этажами и помещениями

### Places (Помещения)

- Отдельные помещения или рабочие места в зданиях
- Привязка к этажам зданий
- Указание характеристик и особенностей помещений

### Clients (Клиенты)

- Управление пользователями системы
- Поддержка различных уровней доступа (USER, ADMIN, OWNER)
- Аутентификация и авторизация

### Visitors (Посещения)

- Бронирования помещений клиентами
- Отслеживание статуса посещений
- Управление временными слотами

### Feedbacks (Отзывы)

- Сбор отзывов о посещениях
- Оценка и текстовые комментарии
- Связь с клиентами и посещениями

## Принципы разработки

Проект следует современным принципам разработки:

1. **Dependency Injection** - для управления зависимостями и облегчения тестирования
2. **Асинхронное программирование** - для повышения производительности и масштабируемости
3. **RESTful API дизайн** - для создания интуитивно понятного API

## Структура директорий

```
backend/
├── src/
│   ├── routers/            # Endpoints API
│   ├── core/               # Конфигурация, настройки, безопасность
│   │   ├── application.py  # Настройка FastAPI приложения
│   │   └── db/                 # Взаимодействие с базой данных
│   │       └── engine.py      # Настройка сессии БД
│   ├── models/             # SQLAlchemy модели
│   ├── repo/               # Репозитории для работы с данными
│   ├── schemes/            # Pydantic модели для валидации
│   ├── service/           # Бизнес-логика
│   ├── main.py             # Точка входа в приложение
│   └── config.py           # Конфигурация приложения
├── tests/                  # Тесты
│   ├── conftest.py         # Конфигурация тестов
│   ├── e2e/        # Интеграционные тесты
│   └── unit/               # Модульные тесты
├── Dockerfile              # Инструкции для сборки Docker образа
├── pyproject.toml          # Зависимости и метаданные проекта
```

## Обработка ошибок и исключений

Система реализует централизованную обработку ошибок с использованием механизмов FastAPI:

- Стандартные HTTP коды ответов для разных ситуаций
- Детализированные сообщения об ошибках

## Межсервисное взаимодействие

В зависимости от размещения системы, она может взаимодействовать с:

- SMTP сервисом для отправки уведомлений
- Внешними системами через API интеграции
- Сервисом хранения файлов (MinIO) через S3-совместимый API