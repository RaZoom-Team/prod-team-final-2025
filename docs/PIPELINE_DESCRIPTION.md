# Описание CI/CD Pipeline для проекта BookIT

## Обзор

Проект BookIT использует легковесную систему непрерывной интеграции и доставки (CI/CD) на базе GitLab CI/CD. Этот
процесс автоматизирует тестирование и развертывание приложения, обеспечивая контроль качества кода и упрощение процесса
доставки обновлений.

## Конфигурация CI/CD

Вся конфигурация CI/CD определена в файле `.gitlab-ci.yml`, находящемся в корне репозитория. Это позволяет
контролировать процесс CI/CD как код и изменять его вместе с остальным кодом проекта.

## Стадии pipeline

Pipeline проекта BookIT включает две основные стадии:

### 1. Тестирование (Tests)

**Назначение**: Выполнение тестов для проверки корректности работы приложения

**Задачи**:

- Запуск юнит и интеграционных тестов с помощью pytest
- Проверка работоспособности кода в изолированной среде

**Технические детали**:

- Использует образ Python 3.12
- Запускается в контейнере Docker (docker:24.0.5-dind)
- Работает с системой управления зависимостями Poetry
- Запускается для ветки master и merge requests

### 2. Развертывание (Deployment)

**Назначение**: Доставка обновлений в production среду

**Задачи**:

- Синхронизация кода с сервером через rsync
- Сборка и запуск контейнеров с помощью Docker Compose

**Технические детали**:

- Использует SSH для подключения к серверу
- Синхронизирует код, исключая файл `.env`
- Выполняет пересборку и перезапуск контейнеров на сервере
- Запускается только для ветки master

**Переменные окружения**:

- `SERVER_USER`: пользователь для доступа к серверу
- `SERVER_HOST`: хост сервера
- `SERVER_DIR`: директория на сервере
- `SSH_PRIVATE_KEY`: приватный ключ для SSH доступа

## Архитектура сервисов

![](/docs-materials/services.png)
